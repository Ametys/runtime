<?xml version="1.0" encoding="UTF-8" ?>
<!--+
    | Copyright (c) 2007 Anyware Technologies and others.
    | All rights reserved. This program and the accompanying materials
    | are made available under the terms of the Eclipse Public License v1.0
    | which accompanies this distribution, and is available at
    | http://www.opensource.org/licenses/eclipse-1.0.php
    | 
    | Contributors:
    |     Anyware Technologies - initial API and implementation
    +-->
<plugin xmlns="http://www.ametys.org/schema/plugin"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.ametys.org/schema/plugin http://www.ametys.org/schema/plugin-2.0.xsd"
        runtimeVersion="2.0" version="2.0">
	<!--
		This is the mandatory plugin included in runtime that comes with :
		<ul>
			<li>mandatory extensions points (users...),</li>
			<li>default implementations,</li>
			<li>screens for the administrator area,</li>
			<li>helpers,</li>
			<li>main database pool,</li>
			<li>...</li>
		</ul>
	 -->

    <config>
        <!-- +
             | CORE DATASOURCE
             + -->
        <!-- JDBC -->
        <param id="runtime.datasource.core.jdbc.driver" type="string">
            <!-- 
                This parameter contains the jdbc driver class to load to connect the core database pool.
             -->
            <label i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_DRIVER_LABEL</label>
            <description i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_DRIVER_DESCRIPTION</description>
            <validation>
                <mandatory/>
            </validation>
            <default-value>com.mysql.jdbc.Driver</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_JDBC_CATEGORY_DATASOURCE</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_JDBC_CATEGORY_DATASOURCE_GROUP_CORE</group>
            <order>10</order>
        </param>
        <param id="runtime.datasource.core.jdbc.url" type="string">
            <!-- 
                This parameter contains the jdbc url to connect the core database pool.
             -->
            <label i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_URL_LABEL</label>
            <description i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_URL_DESCRIPTION</description>
            <validation>
                <mandatory/>
            </validation>
            <default-value>jdbc:mysql://servername/basename</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_JDBC_CATEGORY_DATASOURCE</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_JDBC_CATEGORY_DATASOURCE_GROUP_CORE</group>
            <order>20</order>
        </param>
        <param id="runtime.datasource.core.jdbc.user" type="string">
            <!-- 
                This parameter contains the jdbc username to connect the core database pool.
                @see:plugin{config/runtime.datasource.core.jdbc.passwd}
             -->
            <label i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_USER_LABEL</label>
            <description i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_USER_DESCRIPTION</description>
            <default-value>username</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_JDBC_CATEGORY_DATASOURCE</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_JDBC_CATEGORY_DATASOURCE_GROUP_CORE</group>
            <order>30</order>
        </param>
        <param id="runtime.datasource.core.jdbc.passwd" type="password">
            <!-- 
                This parameter contains the jdbc password to connect the core database pool.
                @see:plugin{config/runtime.datasource.core.jdbc.user}
             -->
            <label i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_PASSWORD_LABEL</label>
            <description i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_PASSWORD_DESCRIPTION</description>
            <default-value>password</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_JDBC_CATEGORY_DATASOURCE</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_JDBC_CATEGORY_DATASOURCE_GROUP_CORE</group>
            <order>40</order>
        </param>
        
        <!-- LDAP -->
        <param id="runtime.datasource.core.ldap.baseUrl" type="string">
            <!-- 
                This parameter contains the base url (protocol + server name + port) to connect to the core ldap connection.
             -->
            <label i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_BASEURL_LABEL</label>
            <description i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_BASEURL_DESCRIPTION</description>
            <validation>
                <mandatory/>
                <regexp>^ldaps?://[\w-.]*(:\d+)?</regexp> 
            </validation>
            <default-value>ldap://server:389</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_CATEGORY_LDAP_GROUP_CORE</group>
            <order>10</order>
        </param>
        <param id="runtime.datasource.core.ldap.useSSL" type="boolean">
            <!-- 
                This parameter determines if the connection to the ldap server is secured or not.<br/>
                Depending on the JVM, the use of 'ldaps' in the protocol is not supported.
             -->
            <label i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_SSL_LABEL</label>
            <description i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_SSL_DESCRIPTION</description>
            <validation>
                <mandatory/>
            </validation>
            <default-value>false</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_CATEGORY_LDAP_GROUP_CORE</group>
            <order>20</order>
        </param>
        <param id="runtime.datasource.core.ldap.baseDN" type="string">
            <!-- 
                This parameter contains the base of the DN to add to all search.
                <br/>May be empty if search have to be done in several branches.
             -->
            <label i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_BASEDN_LABEL</label>
            <description i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_BASEDN_DESCRIPTION</description>
            <validation/>
            <default-value>dc=ametys,dc=org</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_CATEGORY_LDAP_GROUP_CORE</group>
            <order>30</order>
        </param>
        <param id="runtime.datasource.core.ldap.authMethod" type="string">
            <!-- 
                This parameter determines if the connection to LDAP can be anonymous.
                @see:plugin{config/runtime.datasource.core.ldap.adminDN}
                @see:plugin{config/runtime.datasource.core.ldap.adminPasswd}
             -->
            <label i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_AUTH_METHOD_LABEL</label>
            <description i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_AUTH_METHOD_DESCRIPTION</description>
            <enumeration>
            	<entry>
            		<label i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_AUTH_METHOD_ENUM_NONE</label>
            		<value>none</value>
            	</entry>
            	<entry>
            		<label i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_AUTH_METHOD_ENUM_SIMPLE</label>
            		<value>simple</value>
            	</entry>
            </enumeration>
            <validation>
                <mandatory/>
            </validation>
            <default-value>none</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_CATEGORY_LDAP_GROUP_CORE</group>
            <order>40</order>
        </param>
        <param id="runtime.datasource.core.ldap.adminDN" type="string">
            <!-- 
                If the authMethod is not anonymous, this parameter contains the DN of the user to use to connect to the LDAP.
                @see:plugin{config/runtime.datasource.core.ldap.authMethod}
                @see:plugin{config/runtime.datasource.core.ldap.adminPasswd}
             -->
            <label i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_ADMINDN_LABEL</label>
            <description i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_ADMINDN_DESCRIPTION</description>
            <default-value>cn=admin</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_CATEGORY_LDAP_GROUP_CORE</group>
            <order>50</order>
        </param>
        <param id="runtime.datasource.core.ldap.adminPasswd" type="password">
            <!-- 
                If the authMethod is not anonymous, this parameter contains the password of the user to use to connect to the LDAP.
                @see:plugin{config/runtime.datasource.core.ldap.authMethod}
                @see:plugin{config/runtime.datasource.core.ldap.adminDN}
             -->
            <label i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_ADMINPASSWORD_LABEL</label>
            <description i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_ADMINPASSWORD_DESCRIPTION</description>
            <default-value>password</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_LDAP_CONFIG_CATEGORY_LDAP_GROUP_CORE</group>
            <order>60</order>
        </param>
        
        
        <!-- +
             | UPLOAD
             + -->
        <param id="runtime.upload.max-size" type="long">
            <!-- 
                The max size of uploaded files.
             -->
            <label i18n="true">PLUGINS_CORE_UPLOAD_CONFIG_MAXSIZE_LABEL</label>
            <description i18n="true">PLUGINS_CORE_UPLOAD_CONFIG_MAXSIZE_DESCRIPTION</description>
            <validation>
                <mandatory/>
            </validation>        
            <default-value>10000000</default-value>
            <category i18n="true">PLUGINS_CORE_UPLOAD_CONFIG_CATEGORY</category>
            <group i18n="true">PLUGINS_CORE_UPLOAD_CONFIG_GROUP_UPLOAD</group>
            <order>10</order>
        </param>
        <param id="runtime.upload.dir" type="string">
            <!-- 
                The destination directory for uploaded files.
             -->
            <label i18n="true">PLUGINS_CORE_UPLOAD_CONFIG_DIR_LABEL</label>
            <description i18n="true">PLUGINS_CORE_UPLOAD_CONFIG_DIR_DESCRIPTION</description>
            <validation>
                <mandatory/>
            </validation>        
            <default-value>WEB-INF/data/uploads</default-value>
            <category i18n="true">PLUGINS_CORE_UPLOAD_CONFIG_CATEGORY</category>
            <group i18n="true">PLUGINS_CORE_UPLOAD_CONFIG_GROUP_UPLOAD</group>
            <order>20</order>
        </param>
        
        <!-- +
             | USERS
             + -->
        <param id="runtime.users.ldap.peopleDN" type="string">
            <!-- 
                When users are handled in the LDAP, this parameter contains the DN to append to the base DN to guide to users.
                @see:plugin{config/runtime.datasource.core.ldap.baseDN}
             -->
            <label i18n="true">PLUGINS_CORE_USERS_LDAPUSER_CONFIG_PEOPLEDN_LABEL</label>
            <description i18n="true">PLUGINS_CORE_USERS_LDAPUSER_CONFIG_PEOPLEDN_DESCRIPTION</description>
            <validation>
                <mandatory/>
            </validation>        
            <default-value>ou=people</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP_GROUP_USERS</group>
            <order>10</order>
        </param>
        <param id="runtime.users.ldap.baseFilter" type="string">
            <!-- 
                When users are handled in the LDAP, this parameter contains the filter to find users objects in the current DN.
             -->
            <label i18n="true">PLUGINS_CORE_USERS_LDAPUSER_CONFIG_BASEFILTER_LABEL</label>
            <description i18n="true">PLUGINS_CORE_USERS_LDAPUSER_CONFIG_BASEFILTER_DESCRIPTION</description>
            <validation>
                <mandatory/>
                <regexp>\s*\(.*\)\s*</regexp>
            </validation>        
            <default-value>(objectclass=*)</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP_GROUP_USERS</group>
            <order>20</order>
        </param>
        <param id="runtime.users.ldap.scope" type="string">
            <!-- 
                When users are handled in the LDAP, this parameter determine where to look for users objects in the current DN.
                <ul>
                    <li>In the current DN only (object)</li>
                    <li>In the sub branch of current DN only (one)</li>
                    <li>In the current DN and all sub branches (sub) - low perf</li>
                </ul>
             -->
            <label i18n="true">PLUGINS_CORE_USERS_LDAPUSER_CONFIG_SEARCH_SCOPE_LABEL</label>
            <description i18n="true">PLUGINS_CORE_USERS_LDAPUSER_CONFIG_SEARCH_SCOPE_DESCRIPTION</description>
            <enumeration>
            	<custom-enumerator class="org.ametys.runtime.plugins.core.util.ldap.ScopeEnumerator"/>
            </enumeration>
            <validation>
                <mandatory/>
            </validation>
            <default-value>one</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP_GROUP_USERS</group>
            <order>30</order>
        </param>
        <param id="runtime.users.ldap.loginAttr" type="string">
            <!-- 
                When users are handled in the LDAP, this parameter contains the name of the attribute on users objects handling the login
             -->
            <label i18n="true">PLUGINS_CORE_USERS_LDAPUSER_CONFIG_ATTR_LOGIN_LABEL</label>
            <description i18n="true">PLUGINS_CORE_USERS_LDAPUSER_CONFIG_ATTR_LOGIN_DESCRIPTION</description>
            <validation>
                <mandatory/>
            </validation>
            <default-value>uid</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP_GROUP_USERS</group>
            <order>40</order>
        </param>
        <param id="runtime.users.ldap.firstnameAttr" type="string">
            <!-- 
                When users are handled in the LDAP, this parameter contains the name of the attribute on users objects handling the firstname
             -->
            <label i18n="true">PLUGINS_CORE_USERS_LDAPUSER_CONFIG_ATTR_FIRSTNAME_LABEL</label>
            <description i18n="true">PLUGINS_CORE_USERS_LDAPUSER_CONFIG_ATTR_FIRSTNAME_DESCRIPTION</description>
            <default-value>givenName</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP_GROUP_USERS</group>
            <order>50</order>
        </param>
        <param id="runtime.users.ldap.lastnameAttr" type="string">
            <!-- 
                When users are handled in the LDAP, this parameter contains the name of the attribute on users objects handling the lastname
             -->
            <label i18n="true">PLUGINS_CORE_USERS_LDAPUSER_CONFIG_ATTR_LASTNAME_LABEL</label>
            <description i18n="true">PLUGINS_CORE_USERS_LDAPUSER_CONFIG_ATTR_LASTNAME_DESCRIPTION</description>
            <validation>
                <mandatory/>
            </validation>
            <default-value>sn</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP_GROUP_USERS</group>
            <order>60</order>
        </param>
        <param id="runtime.users.ldap.emailAttr" type="string">
            <!-- 
                When users are handled in the LDAP, this parameter contains the name of the attribute on users objects handling the email
             -->
            <label i18n="true">PLUGINS_CORE_USERS_LDAPUSER_CONFIG_ATTR_EMAIL_LABEL</label>
            <description i18n="true">PLUGINS_CORE_USERS_LDAPUSER_CONFIG_ATTR_EMAIL_DESCRIPTION</description>
            <validation>
                <mandatory/>
            </validation>
            <default-value>mail</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP_GROUP_USERS</group>
            <order>70</order>
        </param>
        
        <!-- +
             | GROUPS
             + -->
         
        <!-- LDAP -->
        <param id="runtime.groups.ldap.groupDN" type="string">
            <!-- 
                When groups are handled in the LDAP, this parameter the DN to append to the base DN to guide to groups.
                @see:plugin{config/runtime.datasource.core.ldap.baseDN}
             -->
            <label i18n="true">PLUGINS_CORE_GROUPS_LDAPGROUP_CONFIG_GROUPDN_LABEL</label>
            <description i18n="true">PLUGINS_CORE_GROUPS_LDAPGROUP_CONFIG_GROUPDN_DESCRIPTION</description>
            <validation>
                <mandatory/>
            </validation>
            <default-value>ou=group</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP_GROUP_GROUPS</group>
            <order>10</order>
        </param>
        <param id="runtime.groups.ldap.filter" type="string">
            <!-- 
                When groups are handled in the LDAP, this parameter contains the filter to find groups objects in the current DN.
             -->
            <label i18n="true">PLUGINS_CORE_GROUPS_LDAPGROUP_CONFIG_FILTER_LABEL</label>
            <description i18n="true">PLUGINS_CORE_GROUPS_LDAPGROUP_CONFIG_FILTER_DESCRIPTION</description>
            <validation>
                <mandatory/>
                <regexp>\s*\(.*\)\s*</regexp>
            </validation>
            <default-value>(objectclass=groupOfNames)</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP_GROUP_GROUPS</group>
            <order>20</order>
        </param>
        <param id="runtime.groups.ldap.scope" type="string">
            <!-- 
                When groups are handled in the LDAP, this parameter determine where to look for groups objects in the current DN.
                <ul>
                    <li>In the current DN only (object)</li>
                    <li>In the sub branch of current DN only (one)</li>
                    <li>In the current DN and all sub branches (sub) - low perf</li>
                </ul>
             -->
            <label i18n="true">PLUGINS_CORE_GROUPS_LDAPGROUP_CONFIG_SEARCH_SCOPE_LABEL</label>
            <description i18n="true">PLUGINS_CORE_GROUPS_LDAPGROUP_CONFIG_SEARCH_SCOPE_DESCRIPTION</description>
            <enumeration>
            	<custom-enumerator class="org.ametys.runtime.plugins.core.util.ldap.ScopeEnumerator"/>
            </enumeration>
            <validation>
                <mandatory/>
            </validation>
            <default-value>one</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP_GROUP_GROUPS</group>
            <order>30</order>
        </param>        
        <param id="runtime.groups.ldap.id" type="string">
            <!-- 
                When groups are handled in the LDAP, this parameter contains the name of the attribute on groups objects handling the identifier
             -->
            <label i18n="true">PLUGINS_CORE_GROUPS_LDAPGROUP_CONFIG_ID_LABEL</label>
            <description i18n="true">PLUGINS_CORE_GROUPS_LDAPGROUP_CONFIG_ID_DESCRIPTION</description>
            <validation>
                <mandatory/>
            </validation>
            <default-value>cn</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP_GROUP_GROUPS</group>
            <order>40</order>
        </param>
        <param id="runtime.groups.ldap.description" type="string">
            <!-- 
                When groups are handled in the LDAP, this parameter contains the name of the attribute on groups objects handling the description (or readable name)
             -->
            <label i18n="true">PLUGINS_CORE_GROUPS_LDAPGROUP_CONFIG_DESCRIPTION_LABEL</label>
            <description i18n="true">PLUGINS_CORE_GROUPS_LDAPGROUP_CONFIG_DESCRIPTION_DESCRIPTION</description>
            <validation>
                <mandatory/>
            </validation>
            <default-value>description</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP_GROUP_GROUPS</group>
            <order>50</order>
        </param>
        <param id="runtime.groups.ldap.member" type="string">
            <!-- 
                When groups are handled in the LDAP, this parameter contains the name of the attribute on groups objects handling the assocation with users.<br/>
                This attribute is multiple and will contain the login of users.<br/>
                A user can be part of several groups.
                @see:plugin{config/runtime.users.ldap.peopleDN}
                @see:plugin{config/runtime.users.ldap.loginAttr}
             -->
            <label i18n="true">PLUGINS_CORE_GROUPS_LDAPGROUP_CONFIG_MEMBER_LABEL</label>
            <description i18n="true">PLUGINS_CORE_GROUPS_LDAPGROUP_CONFIG_MEMBER_DESCRIPTION</description>
            <validation>
                <mandatory/>
            </validation>
            <default-value>member</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP_GROUP_GROUPS</group>
            <order>60</order>
        </param>
        <param id="runtime.groups.ldap.memberof" type="string">
            <!-- 
                When groups are handled in the LDAP, this parameter contains the name of the attribute on users objects (implying users to be handled in LDAP also) 
                handling the reverse association to the groups.
                If this attribute is multiple a user can be part of several groups.
                @see:plugin{config/runtime.users.ldap.peopleDN}
                @see:plugin{config/runtime.users.ldap.baseFilter}
                @see:plugin{config/runtime.users.ldap.scope}
                @see:plugin{config/runtime.users.ldap.loginAttr}
             -->
            <label i18n="true">PLUGINS_CORE_GROUPS_LDAPGROUP_CONFIG_MEMBEROF_LABEL</label>
            <description i18n="true">PLUGINS_CORE_GROUPS_LDAPGROUP_CONFIG_MEMBEROF_DESCRIPTION</description>
            <validation>
                <mandatory/>
            </validation>
            <default-value>memberof</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_LDAP_GROUP_USERS</group>
            <order>80</order>
        </param>
        
        <!-- +
             | AUTHENTICATION
             + -->
             
        <!-- BASIC -->
        <param id="runtime.authentication.basic.realm" type="string">
            <!-- 
                This parameter contains the realm name for basic authentication purposes
             -->
            <label i18n="true">PLUGINS_CORE_AUTHENTICATION_BASIC_CONFIG_REALM_LABEL</label>
            <description i18n="true">PLUGINS_CORE_AUTHENTICATION_BASIC_CONFIG_REALM_DESCRIPTION</description>
            <validation>
                <mandatory/>
            </validation>
            <default-value>Application domain name</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_AUTHENTICATION</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_AUTHENTICATION_GROUP_BASIC</group>
            <order>10</order>
        </param>
        
        <!-- REMOTE -->
        <param id="runtime.authentication.remote.realm" type="string">
            <!-- 
                This parameter contains the realm name for remote authentication purposes
             -->
            <label i18n="true">PLUGINS_CORE_AUTHENTICATION_REMOTE_CONFIG_REALM_LABEL</label>
            <description i18n="true">PLUGINS_CORE_AUTHENTICATION_REMOTE_CONFIG_REALM_DESCRIPTION</description>
            <validation>
                <mandatory/>
            </validation>
            <default-value>Remote domain name</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_AUTHENTICATION</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_AUTHENTICATION_GROUP_REMOTE</group>
            <order>10</order>
        </param>
        
        <!-- JCIFS -->
        <param id="runtime.authentication.jcifs.production" type="boolean">
            <!-- 
                This parameter parametrize the JCIFs client in production mode or not determining which other parameters to take in account.
             -->
            <label i18n="true">PLUGINS_CORE_AUTHENTICATION_JCIFS_CONFIG_PRODUCTION_LABEL</label>
            <description i18n="true">PLUGINS_CORE_AUTHENTICATION_JCIFS_CONFIG_PRODUCTION_DESCRIPTION</description>
            <validation>
                <mandatory/>
            </validation>
            <default-value>false</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_AUTHENTICATION</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_AUTHENTICATION_GROUP_JCIFS</group>
            <order>10</order>
        </param>
        <param id="runtime.authentication.jcifs.clientDomain" type="string">
            <!-- 
                This parameter contains the clien domain name.
             -->
            <label i18n="true">PLUGINS_CORE_AUTHENTICATION_JCIFS_CONFIG_CLIENTDOMAIN_LABEL</label>
            <description i18n="true">PLUGINS_CORE_AUTHENTICATION_JCIFS_CONFIG_CLIENTDOMAIN_DESCRIPTION</description>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_AUTHENTICATION</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_AUTHENTICATION_GROUP_JCIFS</group>
            <order>20</order>
        </param>
        <param id="runtime.authentication.jcifs.netBios" type="string">
            <!-- 
                This parameter contains the ip of the net bios server
             -->
            <label i18n="true">PLUGINS_CORE_AUTHENTICATION_JCIFS_CONFIG_NETBIOS_LABEL</label>
            <description i18n="true">PLUGINS_CORE_AUTHENTICATION_JCIFS_CONFIG_NETBIOS_DESCRIPTION</description>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_AUTHENTICATION</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_AUTHENTICATION_GROUP_JCIFS</group>
            <order>30</order>
        </param>
        <param id="runtime.authentication.jcifs.domainController" type="string">
            <!-- 
                This parameter contains the ip of the domain controller
             -->
            <label i18n="true">PLUGINS_CORE_AUTHENTICATION_JCIFS_CONFIG_DOMAINCONTROLLER_LABEL</label>
            <description i18n="true">PLUGINS_CORE_AUTHENTICATION_JCIFS_CONFIG_DOMAINCONTROLLER_DESCRIPTION</description>
            <default-value></default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_AUTHENTICATION</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_AUTHENTICATION_GROUP_JCIFS</group>
            <order>40</order>
        </param>
        
        <!-- CAS -->
        <param id="runtime.authentication.cas.serverUrl" type="string">
            <!-- 
                This parameter contains the url to reach the CAS server
             -->
            <label i18n="true">PLUGINS_CORE_AUTHENTICATION_CAS_CONFIG_URL_LABEL</label>
            <description i18n="true">PLUGINS_CORE_AUTHENTICATION_CAS_CONFIG_URL_DESCRIPTION</description>
            <validation>
                <mandatory/>
                <regexp>^https://</regexp>
            </validation>
            <default-value>https://servername</default-value>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_AUTHENTICATION</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_AUTHENTICATION_GROUP_CAS</group>
            <order>10</order>
        </param>
        <param id="runtime.authentication.cas.authorizedProxy" type="string">
            <!-- 
                This parameter contains the url of the authorized proxies for CAS
             -->
            <label i18n="true">PLUGINS_CORE_AUTHENTICATION_CAS_CONFIG_AUTHORIZEDPROXY_LABEL</label>
            <description i18n="true">PLUGINS_CORE_AUTHENTICATION_CAS_CONFIG_AUTHORIZEDPROXY_DESCRIPTION</description>
            <category i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_AUTHENTICATION</category>
            <group i18n="true">PLUGINS_CORE_DATASOURCE_CORE_CONFIG_CATEGORY_AUTHENTICATION_GROUP_CAS</group>
            <order>20</order>
        </param>
    </config>
    
    <extension-points>
        <extension-point id="org.ametys.runtime.ui.item.UIItemManager"
                         class="org.ametys.runtime.ui.item.UIItemManager"/>
                         
        <extension-point id="org.ametys.runtime.authentication.AuthenticationManager"
                         class="org.ametys.runtime.authentication.AuthenticationManager"/>
                         
        <extension-point id="org.ametys.runtime.plugins.core.right.RightsExtensionPoint"
                         class="org.ametys.runtime.plugins.core.right.RightsExtensionPoint"/>

        <extension-point id="org.apache.cocoon.components.modules.input.InputModuleSelector"
                         class="org.ametys.runtime.cocoon.InputModulesExtensionPoint"/>

        <extension-point id="org.apache.excalibur.source.SourceFactorySelector"
                         class="org.ametys.runtime.cocoon.SourceFactoriesExtensionPoint"/>

        <extension-point id="org.ametys.runtime.datasource.DataSourceExtensionPoint"
                         class="org.ametys.runtime.datasource.DataSourceExtensionPoint"/>

        <extension-point id="org.ametys.runtime.cocoon.SitemapConfigurationExtensionPoint"
                         class="org.ametys.runtime.cocoon.SitemapConfigurationExtensionPoint"/>

        <extension-point id="org.ametys.runtime.plugins.core.sqlmap.SqlMapExtensionPoint"
                         class="org.ametys.runtime.plugins.core.sqlmap.SqlMapExtensionPoint"/>

        <extension-point id="org.ametys.runtime.plugins.core.monitoring.MonitoringExtensionPoint"
                         class="org.ametys.runtime.plugins.core.monitoring.MonitoringExtensionPoint"/>

        <single-extension-point id="org.ametys.runtime.right.RightsManager"
                                class="org.ametys.runtime.right.RightsManager"
                                default-extension-id="org.ametys.runtime.plugins.core.right.Basic"/>

        <single-extension-point id="org.ametys.runtime.user.UsersManager"
                                class="org.ametys.runtime.user.UsersManager"
                                default-extension-id="org.ametys.runtime.plugins.core.user.Static"/>

        <single-extension-point id="org.ametys.runtime.user.CurrentUserProvider"
                                class="org.ametys.runtime.user.CurrentUserProvider"
                                default-extension-id="org.ametys.runtime.plugins.core.user.AvalonCurrentUserProvider"/>

        <single-extension-point id="org.ametys.runtime.group.GroupsManager"
                                class="org.ametys.runtime.group.GroupsManager"
                                default-extension-id="org.ametys.runtime.plugins.core.group.Empty"/>

        <single-extension-point id="org.ametys.runtime.exception.ExceptionHandler"
                                class="org.ametys.runtime.exception.ExceptionHandler"
                                default-extension-id="org.ametys.runtime.plugins.core.exception.Default"/>

        <single-extension-point id="org.ametys.runtime.authentication.CredentialsProvider"
                                class="org.ametys.runtime.authentication.CredentialsProvider"
                                default-extension-id="org.ametys.runtime.plugins.core.authentication.Defined"/>

        <single-extension-point id="org.ametys.runtime.request.InitRequestHandler"
                                class="org.ametys.runtime.request.InitRequestHandler"
                                default-extension-id="org.ametys.runtime.plugins.core.request.Default"/>

        <single-extension-point id="org.ametys.runtime.plugins.core.administrator.version.VersionsHandler"
                                class="org.ametys.runtime.plugins.core.administrator.version.VersionsHandler"
                                default-extension-id="org.ametys.runtime.plugins.core.administrator.version.Default"/>

        <single-extension-point id="org.ametys.runtime.upload.UploadManager"
                                class="org.ametys.runtime.upload.UploadManager"
                                default-extension-id="org.ametys.runtime.plugins.core.upload.FSUploadManager"/>
    </extension-points>
    
    <feature name="saxclienthelper">
    	<components>
    		<component class="org.ametys.runtime.ui.SAXClientSideElementHelper" 
    				   role="org.ametys.runtime.ui.SAXClientSideElementHelper"/>
    	</components>
    </feature>
    
    <feature name="runtime.core">
        <!-- 
            This feature is a mandatory feature of the runtime defining basic tools
         -->
        <components>
            <component role="org.ametys.runtime.request.RequestListenerManager" 
                       class="org.ametys.runtime.request.RequestListenerManager"/>
            
            <component role="org.apache.excalibur.source.SourceResolver" 
                       class="org.apache.excalibur.source.impl.SourceResolverImpl"/>
                       
            <component role="org.apache.excalibur.xml.xslt.XSLTProcessor/xalan"
                       class="org.ametys.runtime.cocoon.ThreadSafeTraxProcessor" >
                <parameter name="incremental-processing" value="false"/>
                <parameter name="transformer-factory" value="org.apache.xalan.processor.TransformerFactoryImpl"/>
            </component>
        </components>
        
        <extensions>
            <extension point="org.apache.cocoon.components.modules.input.InputModuleSelector"
                       id="config"
                       class="org.ametys.runtime.config.ConfigInputModule"
                       logger="org.ametys.runtime.config.ConfigInputModule"/>
            <extension point="org.apache.cocoon.components.modules.input.InputModuleSelector"
                       id="parent-context-attr"
                       class="org.ametys.runtime.util.cocoon.ParentContextInputModule"
                       logger="org.ametys.runtime.util.cocoon.ParentContextInputModule"/>
            <extension point="org.apache.cocoon.components.modules.input.InputModuleSelector"
                       id="context-attr"
                       class="org.ametys.runtime.util.cocoon.ContextAttributesInputModule"
                       logger="org.ametys.runtime.util.cocoon.ContextAttributesInputModule"/>
                       
            <extension point="org.ametys.runtime.authentication.AuthenticationManager"
                       id="org.ametys.runtime.plugins.core.authentication.UsersManagerAuthentication"
                       class="org.ametys.runtime.plugins.core.authentication.UsersManagerAuthentication"
                       logger="org.ametys.runtime.plugins.core.authentication.UsersManagerAuthentication"/>
                       
            <extension point="org.ametys.runtime.authentication.AuthenticationManager"
                       id="org.ametys.runtime.plugins.core.authentication.HasRightManager"
                       class="org.ametys.runtime.plugins.core.authentication.HasRightManager"
                       logger="org.ametys.runtime.plugins.core.authentication.HasRightManager"/>
        </extensions>
    </feature>
    
    <feature name="runtime.core.has_right_sitemap_components">
        <extensions>
            <extension point="org.ametys.runtime.cocoon.SitemapConfigurationExtensionPoint"
                        id="org.ametys.plugin.core.SitemapConfigurationExtensionPoint">
            
                <action name="has-not-right" src="org.ametys.runtime.plugins.core.right.actions.HasRightAction" logger="org.ametys.runtime.plugins.core.administrator.sitemap.action.hasRight">
                    <has-right>false</has-right>
                    <base-context>/application</base-context>
                </action>
                <action name="has-right" src="org.ametys.runtime.plugins.core.right.actions.HasRightAction" logger="org.ametys.runtime.plugins.core.administrator.sitemap.action.hasRight">
                    <has-right>true</has-right>
                    <base-context>/application</base-context>
                </action>
                        
            </extension>
        </extensions>
    </feature>

    <feature name="runtime.datasource.core">
        <!--
            This feature defines the pool of connection to the database.
         -->
        <config>
            <param-ref id="runtime.datasource.core.jdbc.driver"/>
            <param-ref id="runtime.datasource.core.jdbc.url"/>
            <param-ref id="runtime.datasource.core.jdbc.user"/>
            <param-ref id="runtime.datasource.core.jdbc.passwd"/>
        </config>
        
        <extensions>
            <extension point="org.ametys.runtime.datasource.DataSourceExtensionPoint" 
                       id="runtime.datasource.core.jdbc.pool"
                       logger="org.ametys.runtime.datasource.core.jdbc.pool">
                <driver runtime-config-parameter="runtime.datasource.core.jdbc.driver"/>
                <dburl runtime-config-parameter="runtime.datasource.core.jdbc.url"/>
                <user runtime-config-parameter="runtime.datasource.core.jdbc.user"/>
                <password runtime-config-parameter="runtime.datasource.core.jdbc.passwd"/>
            </extension>
        </extensions>
    </feature>
    
    <feature name="runtime.upload">
        <config>
            <param-ref id="runtime.upload.max-size"/>
            <param-ref id="runtime.upload.dir"/>
        </config>
    </feature>
    
    <feature name="runtime.upload.manager.fs">
        <!--
            This feature defines components needed by the file system upload manager
         -->
        <extensions>
        	<extension point="org.ametys.runtime.upload.UploadManager"
        	           id="org.ametys.runtime.plugins.core.upload.FSUploadManager"
        	           class="org.ametys.runtime.plugins.core.upload.FSUploadManager">
        		<!-- UploadManager for storing uploaded files into /WEB-INF/data/uploads-user -->
        	</extension>
        </extensions>
    </feature>
    
    

    <feature name="runtime.workspace.admin">
        <!--
            This feature defines components needed by the workspace admin
         -->
        <components>
            <component role="org.ametys.runtime.workspaces.admin.DesktopManager" 
                class="org.ametys.runtime.plugins.core.ui.item.DesktopManager" 
                config="/WEB-INF/param/workspace-admin.xml"/>
        </components>
    </feature>
    
    <feature name="runtime.admin">
        <!-- 
            This feature defines screen that may be uses in the administrator area
         -->
        <extensions>
            <!-- +
                 |  ADMIN PASSWORD
                 + -->
            <extension  point="org.ametys.runtime.ui.item.UIItemManager" 
                        id="org.ametys.runtime.plugins.core.administrator.Password"
                        class="org.ametys.runtime.plugins.core.ui.item.StaticAdminUIItemFactory"
                        logger="org.ametys.runtime.plugins.core.ui.administrator.password">
                <!-- 
                    This interaction allows the administrator to change its password
                 -->
                <Static>
                    <LabelKey>PLUGINS_CORE_ADMINISTRATOR_PASSWORD_LABEL</LabelKey>
                    <DescriptionKey>PLUGINS_CORE_ADMINISTRATOR_PASSWORD_DESCRIPTION</DescriptionKey>
                    <Icons>
                        <Small>img/administrator/password/icon_dock.png</Small>
                        <Medium>img/administrator/password/icon_medium.gif</Medium>
                        <Large>img/administrator/password/icon_large.png</Large>
                    </Icons>
                    <Action type="class">
                        <Class value="org.ametys.administration.Password"/>
                        <Imports>
                            <File>js/org/ametys/administration/Password.i18n.js</File>
                        </Imports>
                    </Action>
                </Static>
            </extension>
            
            <!-- +
                 |  ADMIN CONFIGURATION
                 + -->
            <extension  point="org.ametys.runtime.ui.item.UIItemManager" 
                        id="org.ametys.runtime.plugins.core.administrator.Config"
                        class="org.ametys.runtime.plugins.core.ui.item.StaticAdminUIItemFactory"
                        logger="org.ametys.runtime.plugins.core.ui.administrator.config">
                <!-- 
                    This interaction allows the administrator to change the main configuration of the application
                 -->
                <Static>
                    <LabelKey>PLUGINS_CORE_ADMINISTRATOR_CONFIG_LABEL</LabelKey>
                    <DescriptionKey>PLUGINS_CORE_ADMINISTRATOR_CONFIG_DESCRIPTION</DescriptionKey>
                    <Icons>
                        <Small>img/administrator/config/icon_dock.png</Small>
                        <Medium>img/administrator/config/icon_medium.gif</Medium>
                        <Large>img/administrator/config/icon_large.png</Large>
                    </Icons>
                    <Action type="url">
                        <Url value="administrator/config/edit.html"/>
                    </Action>
                    <Url>administrator/config/edit\.html</Url>
                </Static>
            </extension>
            
            <!-- +
                 |  ADMIN JVMSTATUS
                 + -->
            <extension  point="org.ametys.runtime.ui.item.UIItemManager" 
                        id="org.ametys.runtime.plugins.core.administrator.JVMStatus"
                        class="org.ametys.runtime.plugins.core.ui.item.StaticAdminUIItemFactory"
                        logger="org.ametys.runtime.plugins.core.ui.administrator.status">
                <!-- 
                    This interaction allows the administrator to check the status of the JVM
                 -->
                <Static>
                    <LabelKey>PLUGINS_CORE_ADMINISTRATOR_STATUS_LABEL</LabelKey>
                    <DescriptionKey>PLUGINS_CORE_ADMINISTRATOR_STATUS_DESCRIPTION</DescriptionKey>
                    <Icons>
                        <Small>img/administrator/jvmstatus/icon_dock.png</Small>
                        <Medium>img/administrator/jvmstatus/icon_medium.gif</Medium>
                        <Large>img/administrator/jvmstatus/icon_large.png</Large>
                    </Icons>
                    <Action type="url">
                        <Url value="administrator/jvmstatus/view.html"/>
                    </Action>
                    <Url>administrator/jvmstatus/view\.html</Url>
                </Static>
            </extension> 

            <!-- +
                 |  ADMIN PLUGINS
                 + -->           
            <extension  point="org.ametys.runtime.ui.item.UIItemManager" 
                        id="org.ametys.runtime.plugins.core.administrator.Plugins"
                        class="org.ametys.runtime.plugins.core.ui.item.StaticAdminUIItemFactory"
                        logger="org.ametys.runtime.plugins.core.ui.administrator.plugins">
                <!-- 
                    This interaction allows the administrator to see plugins. Usefull for developpers.
                 -->
                <Static>
                    <LabelKey>PLUGINS_CORE_ADMINISTRATOR_PLUGINS_LABEL</LabelKey>
                    <DescriptionKey>PLUGINS_CORE_ADMINISTRATOR_PLUGINS_DESCRIPTION</DescriptionKey>
                    <Icons>
                        <Small>img/administrator/plugins/icon_dock.png</Small>
                        <Medium>img/administrator/plugins/icon_medium.gif</Medium>
                        <Large>img/administrator/plugins/icon_large.png</Large>
                    </Icons>
                    <Action type="url">
                        <Url value="administrator/plugins/view.html"/>
                    </Action>
                    <Url>administrator/plugins/view\.html</Url>
                </Static>
            </extension> 
            
            <!-- +
                 |  ADMIN LOGS
                 + -->           
            <extension  point="org.ametys.runtime.ui.item.UIItemManager" 
                        id="org.ametys.runtime.plugins.core.administrator.Logs"
                        class="org.ametys.runtime.plugins.core.ui.item.StaticAdminUIItemFactory"
                        logger="org.ametys.runtime.plugins.core.ui.administrator.logs">
                <!-- 
                    This interaction allows the administrator to see and manage logs
                 -->
                <Static>
                    <LabelKey>PLUGINS_CORE_ADMINISTRATOR_LOGS_LABEL</LabelKey>
                    <DescriptionKey>PLUGINS_CORE_ADMINISTRATOR_LOGS_DESCRIPTION</DescriptionKey>
                    <Icons>
                        <Small>img/administrator/logs/icon_dock.png</Small>
                        <Medium>img/administrator/logs/icon_medium.gif</Medium>
                        <Large>img/administrator/logs/icon_large.png</Large>
                    </Icons>
                    <Action type="url">
                        <Url value="administrator/logs/view.html"/>
                    </Action>
                    <Url>administrator/logs/view\.html</Url>
                </Static>
            </extension>             

            <!-- +
                 |  ADMIN SYSTEM
                 + -->           
            <extension  point="org.ametys.runtime.ui.item.UIItemManager" 
                        id="org.ametys.runtime.plugins.core.administrator.System"
                        class="org.ametys.runtime.plugins.core.ui.item.StaticAdminUIItemFactory"
                        logger="org.ametys.runtime.plugins.core.ui.administrator.system">
                <!-- 
                    This interaction allows the administrator to handle the system (maintenance mode, welcome message...)
                 -->
                <Static>
                    <LabelKey>PLUGINS_CORE_ADMINISTRATOR_SYSTEM_LABEL</LabelKey>
                    <DescriptionKey>PLUGINS_CORE_ADMINISTRATOR_SYSTEM_DESCRIPTION</DescriptionKey>
                    <Icons>
                        <Small>img/administrator/system/icon_dock.png</Small>
                        <Medium>img/administrator/system/icon_medium.gif</Medium>
                        <Large>img/administrator/system/icon_large.png</Large>
                    </Icons>
                    <Action type="url">
                        <Url value="administrator/system/view.html"/>
                    </Action>
                    <Url>administrator/system/view\.html</Url>
           		</Static>
            </extension>   
               
        </extensions>
    </feature>
    
    <!-- +
    	 |  VERSIONS
         + -->    
    <feature name="runtime.version">       
    	<extensions>
            <extension  point="org.ametys.runtime.plugins.core.administrator.version.VersionsHandler" 
                        id="org.ametys.runtime.plugins.core.administrator.version.Default"
                        class="org.ametys.runtime.plugins.core.administrator.version.DefaultVersionsHandler"
                        logger="org.ametys.runtime.plugins.core.administrator.versions"/>
        </extensions>
    </feature>

     <!-- +
         |  USERS
         + -->   
    <feature name="runtime.users">
        <!-- 
            This feature contains only the interaction for handling users
         -->
        <extensions>
            <extension  point="org.ametys.runtime.ui.item.UIItemManager" 
                        id="org.ametys.runtime.plugins.core.Users"
                        class="org.ametys.runtime.plugins.core.ui.item.StaticAdminUIItemFactory"
                        logger="org.ametys.runtime.plugins.core.ui.users">
                <!-- 
                    This interaction allow to handle users (read or read/write)
                 -->
                <Static>
                    <LabelKey>PLUGINS_CORE_USERS_LABEL</LabelKey>
                    <DescriptionKey>PLUGINS_CORE_USERS_DESCRIPTION</DescriptionKey>
                    <Icons>
                        <Small>img/users/icon_dock.png</Small>
                        <Medium>img/users/icon_medium.gif</Medium>
                        <Large>img/users/icon_large.png</Large>
                    </Icons>
                    <Action type="url">
                        <Url value="users/view.html"/>
                    </Action>
                    <Right>Runtime_Rights_User_Handle</Right>
                    <Url>users/view\.html</Url>
                </Static>
            </extension>      
        </extensions>
    </feature>
    
    <feature name="runtime.users.rights">
        <!-- 
            This feature brings the rights needed to manage users
         -->
        <extensions>
            <extension point="org.ametys.runtime.plugins.core.right.RightsExtensionPoint"
                       id="runtime.use.rights.users">
                <!-- 
                    Define the right for handling users
                 -->
                <right id="Runtime_Rights_User_Handle">
                    <label>PLUGINS_CORE_USERS_RIGHTS_HANDLE_LABEL</label>
                    <description>PLUGINS_CORE_USERS_RIGHTS_HANDLE_DESCRIPTION</description>
                    <category>PLUGINS_CORE_USERANDRIGHTS_CATEGORY</category>
                </right>
            </extension>
        </extensions>
    </feature>
    
    <feature name="runtime.user.impl.static">
        <!-- 
            This features defines the static implementation of users
         -->
        <extensions>
            <extension point="org.ametys.runtime.user.UsersManager"
                       id="org.ametys.runtime.plugins.core.user.Static"
                       class="org.ametys.runtime.plugins.core.user.StaticUsersManager"
                       logger="org.ametys.runtime.plugins.core.users.static">
                <user id="anonymous">
                    <fullname>Anonymous user</fullname>
                </user>
            </extension>
        </extensions>
    </feature>
    
    <feature name="runtime.user.impl.jdbc.core" depends="runtime.datasource.core">
        <!-- 
            This features defines the base jdbc implementation of users (based on core database pool) 
         -->
        <extensions>
            <extension point="org.ametys.runtime.user.UsersManager"
                       id="org.ametys.runtime.plugins.core.user.CoreJdbc"
                       class="org.ametys.runtime.plugins.core.user.jdbc.JdbcUsersManager"
                       logger="org.ametys.runtime.plugins.core.users.jdbc.simple">
                <pool>runtime.datasource.core.jdbc.pool</pool>
                <table>Users</table>
                <param id="login"/>
                <param id="firstname"/>
                <param id="lastname"/>
                <param id="email"/>
            </extension>
        </extensions>
    </feature>
    
    <feature name="runtime.user.impl.jdbc.modifiable.core" depends="runtime.datasource.core">
        <!-- 
            The same as runtime.user.impl.jdbc.core but where users can be modified through the API
            @see:plugin{feature/runtime.user.impl.jdbc.core}
         -->
        <extensions>
            <extension point="org.ametys.runtime.user.UsersManager"
                       id="org.ametys.runtime.plugins.core.user.CoreModifiableJdbc"
                       class="org.ametys.runtime.plugins.core.user.jdbc.ModifiableJdbcUsersManager"
                       logger="org.ametys.runtime.plugins.core.users.jdbc.modifiable">
                <pool>runtime.datasource.core.jdbc.pool</pool>
                <table>Users</table>
                <param id="login"/>
                <param id="firstname"/>
                <param id="lastname"/>
                <param id="email"/>
            </extension>
        </extensions>
    </feature>
    
    <feature name="runtime.user.impl.jdbc.credentialsaware.core" depends="runtime.datasource.core">
        <!-- 
            The same as runtime.user.impl.jdbc.core but where users can be authentified through the API
            @see:plugin{feature/runtime.user.impl.jdbc.core}
         -->
        <extensions>
            <extension point="org.ametys.runtime.user.UsersManager"
                       id="org.ametys.runtime.plugins.core.user.CoreCredentialsAwareJdbc"
                       class="org.ametys.runtime.plugins.core.user.jdbc.CredentialsAwareJdbcUsersManager"
                       logger="org.ametys.runtime.plugins.core.users.jdbc.credential">
                <pool>runtime.datasource.core.jdbc.pool</pool>
                <table>Users</table>
                <param id="login"/>
                <param id="password"/>
                <param id="firstname"/>
                <param id="lastname"/>
                <param id="email"/>
            </extension>
        </extensions>
    </feature>
    
    <feature name="runtime.user.impl.jdbc.modifiablecredentialsaware.core" depends="runtime.datasource.core">
        <!-- 
            The same as runtime.user.impl.jdbc.core but where users can be modified and authentified through the API
            @see:plugin{feature/runtime.user.impl.jdbc.core}
            @see:plugin{feature/runtime.user.impl.jdbc.modifiable.core}
            @see:plugin{feature/runtime.user.impl.jdbc.credentialsaware.core}
         -->
        <extensions>
            <extension point="org.ametys.runtime.user.UsersManager"
                       id="org.ametys.runtime.plugins.core.user.CoreModifiableCredentialsAwareJdbc"
                       class="org.ametys.runtime.plugins.core.user.jdbc.ModifiableCredentialsAwareJdbcUsersManager"
                       logger="org.ametys.runtime.plugins.core.users.jdbc.credentialmodifiable">
                <pool>runtime.datasource.core.jdbc.pool</pool>
                <table>Users</table>
                <param id="login"/>
                <param id="password"/>
                <param id="firstname"/>
                <param id="lastname"/>
                <param id="email"/>
            </extension>
        </extensions>
    </feature>
    
    <feature name="runtime.user.impl.ldap">
        <!-- 
            This features defines the base ldap implementation of users
         -->
        <config>
            <param-ref id="runtime.datasource.core.ldap.baseUrl"/>
            <param-ref id="runtime.datasource.core.ldap.useSSL"/>
            <param-ref id="runtime.datasource.core.ldap.baseDN"/>
            <param-ref id="runtime.datasource.core.ldap.authMethod"/>
            <param-ref id="runtime.datasource.core.ldap.adminDN"/>
            <param-ref id="runtime.datasource.core.ldap.adminPasswd"/>

            <param-ref id="runtime.users.ldap.peopleDN"/>
            <param-ref id="runtime.users.ldap.baseFilter"/>
            <param-ref id="runtime.users.ldap.scope"/>
            <param-ref id="runtime.users.ldap.loginAttr"/>
            <param-ref id="runtime.users.ldap.firstnameAttr"/>
            <param-ref id="runtime.users.ldap.lastnameAttr"/>
            <param-ref id="runtime.users.ldap.emailAttr"/>
        </config>
        <extensions>
            <extension point="org.ametys.runtime.user.UsersManager"
                       id="org.ametys.runtime.plugins.core.Ldap"
                       class="org.ametys.runtime.plugins.core.user.ldap.LdapUsersManager"
                       logger="org.ametys.runtime.plugins.core.user.ldap.simple">
                <BaseUrl>runtime.datasource.core.ldap.baseUrl</BaseUrl>
                <UseSSL>runtime.datasource.core.ldap.useSSL</UseSSL>
                <BaseDN>runtime.datasource.core.ldap.baseDN</BaseDN>
                <AuthenticationMethod>runtime.datasource.core.ldap.authMethod</AuthenticationMethod>
                <AdminDN>runtime.datasource.core.ldap.adminDN</AdminDN>
                <AdminPassword>runtime.datasource.core.ldap.adminPasswd</AdminPassword>

                <RelativeDN>runtime.users.ldap.peopleDN</RelativeDN>
                <Filter>runtime.users.ldap.baseFilter</Filter>
                <SearchScope>runtime.users.ldap.scope</SearchScope>
                <Login>runtime.users.ldap.loginAttr</Login>
                <Firstname>runtime.users.ldap.firstnameAttr</Firstname>
                <Lastname>runtime.users.ldap.lastnameAttr</Lastname>
                <Email mandatory="false">runtime.users.ldap.emailAttr</Email>
            </extension>
        </extensions>
    </feature>
        
    <feature name="runtime.user.impl.ldap.credentialsaware">
        <!-- 
            The same as runtime.user.impl.ldap but where users can be authentified through the API
            @see:plugin{feature/runtime.user.impl.ldap}
         -->
        <config>
            <param-ref id="runtime.datasource.core.ldap.baseUrl"/>
            <param-ref id="runtime.datasource.core.ldap.useSSL"/>
            <param-ref id="runtime.datasource.core.ldap.baseDN"/>
            <param-ref id="runtime.datasource.core.ldap.authMethod"/>
            <param-ref id="runtime.datasource.core.ldap.adminDN"/>
            <param-ref id="runtime.datasource.core.ldap.adminPasswd"/>

            <param-ref id="runtime.users.ldap.peopleDN"/>
            <param-ref id="runtime.users.ldap.baseFilter"/>
            <param-ref id="runtime.users.ldap.scope"/>
            <param-ref id="runtime.users.ldap.loginAttr"/>
            <param-ref id="runtime.users.ldap.firstnameAttr"/>
            <param-ref id="runtime.users.ldap.lastnameAttr"/>
            <param-ref id="runtime.users.ldap.emailAttr"/>
        </config>
        <extensions>
            <extension point="org.ametys.runtime.user.UsersManager"
                       id="org.ametys.runtime.plugins.core.CredentialsAwareLdap"
                       class="org.ametys.runtime.plugins.core.user.ldap.CredentialsAwareLdapUsersManager"
                       logger="org.ametys.runtime.plugins.core.user.ldap.credential">
                <BaseUrl>runtime.datasource.core.ldap.baseUrl</BaseUrl>
                <UseSSL>runtime.datasource.core.ldap.useSSL</UseSSL>
                <BaseDN>runtime.datasource.core.ldap.baseDN</BaseDN>
                <AuthenticationMethod>runtime.datasource.core.ldap.authMethod</AuthenticationMethod>
                <AdminDN>runtime.datasource.core.ldap.adminDN</AdminDN>
                <AdminPassword>runtime.datasource.core.ldap.adminPasswd</AdminPassword>

                <RelativeDN>runtime.users.ldap.peopleDN</RelativeDN>
                <Filter>runtime.users.ldap.baseFilter</Filter>
                <SearchScope>runtime.users.ldap.scope</SearchScope>
                <Login>runtime.users.ldap.loginAttr</Login>
                <Firstname>runtime.users.ldap.firstnameAttr</Firstname>
                <Lastname>runtime.users.ldap.lastnameAttr</Lastname>
                <Email mandatory="false">runtime.users.ldap.emailAttr</Email>
            </extension>
        </extensions>
    </feature>
    
    <feature name="runtime.util.ldap.scope.enumerator">
        <!-- 
            This feature provides a LDAP scope enumerator
         -->
    	<components>
    		<component role="org.ametys.runtime.plugins.core.util.ldap.ScopeEnumerator"
    		           class="org.ametys.runtime.plugins.core.util.ldap.ScopeEnumerator"/>
    	</components>
    </feature>
    
    <!-- +
         |  CURRENT USER PROVIDER
         + -->   
    <feature name="runtime.current-user">
        <!-- 
            This feature provides a non-null current user
         -->
		<extensions>
			<!-- Default extension for providing the current user -->
			<extension point="org.ametys.runtime.user.CurrentUserProvider"
			           id="org.ametys.runtime.plugins.core.user.AvalonCurrentUserProvider"
			           class="org.ametys.runtime.plugins.core.user.AvalonCurrentUserProvider">
				<user default="admin"/>
			</extension>
		</extensions>
    </feature>
        
    <!-- +
         |  GROUPS
         + -->   
    <feature name="runtime.groups">
        <!-- 
            This feature contains only the interaction for handling groups
         -->
        <extensions>
            <extension  point="org.ametys.runtime.ui.item.UIItemManager" 
                        id="org.ametys.runtime.plugins.core.Groups"
                        class="org.ametys.runtime.plugins.core.ui.item.StaticAdminUIItemFactory"
                        logger="org.ametys.runtime.plugins.core.ui.groups">
                <!-- 
                    This interaction allow to handle groups (read or read/write)
                 -->
                <Static>
                    <LabelKey>PLUGINS_CORE_GROUPS_LABEL</LabelKey>
                    <DescriptionKey>PLUGINS_CORE_GROUPS_DESCRIPTION</DescriptionKey>
                    <Icons>
                        <Small>img/groups/icon_dock.png</Small>
                        <Medium>img/groups/icon_medium.gif</Medium>
                        <Large>img/groups/icon_large.png</Large>
                    </Icons>
                    <Action type="url">
                        <Url value="groups/view.html"/>
                    </Action>
                    <Right>Runtime_Rights_Group_Handle</Right>
                    <Url>groups/view\.html</Url>
                </Static>
            </extension>      
        </extensions>
    </feature>
    
    <feature name="runtime.groups.rights">
        <!-- 
            This feature brings the rights needed to manage groups
         -->
        <extensions>
            <extension point="org.ametys.runtime.plugins.core.right.RightsExtensionPoint"
                       id="runtime.use.rights.groups">
                <!-- 
                    Define the right for handling groups
                 -->
                <right id="Runtime_Rights_Group_Handle">
                    <label>PLUGINS_CORE_GROUPS_RIGHTS_HANDLE_LABEL</label>
                    <description>PLUGINS_CORE_GROUPS_RIGHTS_HANDLE_DESCRIPTION</description>
                    <category>PLUGINS_CORE_USERANDRIGHTS_CATEGORY</category>
                </right>
            </extension>
        </extensions>
    </feature>
    
    <feature name="runtime.groups.impl.empty">
        <!-- 
            This features defines an 'empty' groups to avoid group handling.
         -->
        <extensions>
            <extension point="org.ametys.runtime.group.GroupsManager"
                       id="org.ametys.runtime.plugins.core.group.Empty"
                       class="org.ametys.runtime.plugins.core.group.EmptyGroupsManager"
                       logger="org.ametys.runtime.plugins.core.group.empty"/>
        </extensions>
    </feature>
    
    <feature name="runtime.groups.impl.jdbc" depends="runtime.datasource.core">
        <!-- 
            This features defines the base jdbc implementation of users (based on core database pool)
         -->
        <extensions>
            <extension point="org.ametys.runtime.group.GroupsManager"
                       id="org.ametys.runtime.plugins.core.group.ModifiableJdbcCore"
                       class="org.ametys.runtime.plugins.core.group.jdbc.ModifiableJdbcGroupsManager"
                       logger="org.ametys.runtime.plugins.core.group.jdbc">
                <pool>runtime.datasource.core.jdbc.pool</pool>
                <list>
                    <table>Groups</table>
                    <id>Id</id>
                    <label>Label</label>
                </list>
                <composition>
                    <table>Groups_Users</table>
                    <group>Group_Id</group>
                    <user>Login</user>
                </composition>
            </extension>                   
        </extensions>
    </feature>

    <feature name="runtime.groups.impl.ldap.groupDriven">
        <!-- 
            This features defines the base ldap implementation of groups where the group information is handle by the group object
         -->
        <config>
            <param-ref id="runtime.datasource.core.ldap.baseUrl"/>
            <param-ref id="runtime.datasource.core.ldap.useSSL"/>
            <param-ref id="runtime.datasource.core.ldap.baseDN"/>
            <param-ref id="runtime.datasource.core.ldap.authMethod"/>
            <param-ref id="runtime.datasource.core.ldap.adminDN"/>
            <param-ref id="runtime.datasource.core.ldap.adminPasswd"/>
            
            <param-ref id="runtime.groups.ldap.groupDN"/>
            <param-ref id="runtime.groups.ldap.filter"/>
            <param-ref id="runtime.groups.ldap.scope"/>
            <param-ref id="runtime.groups.ldap.id"/>
            <param-ref id="runtime.groups.ldap.description"/>
            <param-ref id="runtime.groups.ldap.member"/>
            
            <param-ref id="runtime.users.ldap.peopleDN"/>
            <param-ref id="runtime.users.ldap.loginAttr"/>
        </config>
        <extensions>
            <extension point="org.ametys.runtime.group.GroupsManager"
                       id="org.ametys.runtime.plugins.core.group.GroupDrivenLdap"
                       class="org.ametys.runtime.plugins.core.group.ldap.GroupDrivenLdapGroupsManager"
                       logger="org.ametys.runtime.plugins.core.group.groupdriven">
                <BaseUrl>runtime.datasource.core.ldap.baseUrl</BaseUrl>
                <UseSSL>runtime.datasource.core.ldap.useSSL</UseSSL>
                <BaseDN>runtime.datasource.core.ldap.baseDN</BaseDN>
                <AuthenticationMethod>runtime.datasource.core.ldap.authMethod</AuthenticationMethod>
                <AdminDN>runtime.datasource.core.ldap.adminDN</AdminDN>
                <AdminPassword>runtime.datasource.core.ldap.adminPasswd</AdminPassword>
                
                <RelativeDN>runtime.groups.ldap.groupDN</RelativeDN>
                <Filter>runtime.groups.ldap.filter</Filter>
                <SearchScope>runtime.groups.ldap.scope</SearchScope>
                <Id>runtime.groups.ldap.id</Id>
                <Description>runtime.groups.ldap.description</Description>
                <Member>runtime.groups.ldap.member</Member>
                
                <UsersRelativeDN>runtime.users.ldap.peopleDN</UsersRelativeDN>
                <Login>runtime.users.ldap.loginAttr</Login>
            </extension>
        </extensions>
    </feature>
                 
    <feature name="runtime.groups.impl.ldap.usersDriven">
        <!-- 
            This features defines the base ldap implementation of groups where the group information is handle by the user object
         -->
        <config>
            <param-ref id="runtime.datasource.core.ldap.baseUrl"/>
            <param-ref id="runtime.datasource.core.ldap.useSSL"/>
            <param-ref id="runtime.datasource.core.ldap.baseDN"/>
            <param-ref id="runtime.datasource.core.ldap.authMethod"/>
            <param-ref id="runtime.datasource.core.ldap.adminDN"/>
            <param-ref id="runtime.datasource.core.ldap.adminPasswd"/>
            
            <param-ref id="runtime.groups.ldap.groupDN"/>
            <param-ref id="runtime.groups.ldap.filter"/>
            <param-ref id="runtime.groups.ldap.scope"/>
            <param-ref id="runtime.groups.ldap.id"/>
            <param-ref id="runtime.groups.ldap.description"/>
            <param-ref id="runtime.groups.ldap.memberof"/>
            
            <param-ref id="runtime.users.ldap.peopleDN"/>
            <param-ref id="runtime.users.ldap.baseFilter"/>
            <param-ref id="runtime.users.ldap.scope"/>
            <param-ref id="runtime.users.ldap.loginAttr"/>
        </config>
        <extensions>
            <extension point="org.ametys.runtime.group.GroupsManager"
                       id="org.ametys.runtime.plugins.core.group.UsersDrivenLdap"
                       class="org.ametys.runtime.plugins.core.group.ldap.UserDrivenLdapGroupsManager"
                       logger="org.ametys.runtime.plugins.core.group.usersdriven">
                <BaseUrl>runtime.datasource.core.ldap.baseUrl</BaseUrl>
                <UseSSL>runtime.datasource.core.ldap.useSSL</UseSSL>
                <BaseDN>runtime.datasource.core.ldap.baseDN</BaseDN>
                <AuthenticationMethod>runtime.datasource.core.ldap.authMethod</AuthenticationMethod>
                <AdminDN>runtime.datasource.core.ldap.adminDN</AdminDN>
                <AdminPassword>runtime.datasource.core.ldap.adminPasswd</AdminPassword>
                
                <RelativeDN>runtime.groups.ldap.groupDN</RelativeDN>
                <Filter>runtime.groups.ldap.filter</Filter>
                <SearchScope>runtime.groups.ldap.scope</SearchScope>
                <Id>runtime.groups.ldap.id</Id>
                <Description>runtime.groups.ldap.description</Description>
                <MemberOf>runtime.groups.ldap.memberof</MemberOf>

                <UsersRelativeDN>runtime.users.ldap.peopleDN</UsersRelativeDN>
                <UsersFilter>runtime.users.ldap.baseFilter</UsersFilter>
                <UsersSearchScope>runtime.users.ldap.scope</UsersSearchScope>
                <UsersLogin>runtime.users.ldap.loginAttr</UsersLogin>
            </extension>
        </extensions>
    </feature>
                 
    <!-- +
         |  RIGHTS
         + -->   
    <feature name="runtime.rights">
        <!-- 
            This feature contains interactions to handle rights based on profiles
         -->
        <extensions>
            <extension  point="org.ametys.runtime.ui.item.UIItemManager" 
                        id="org.ametys.runtime.plugins.core.right.Profiles"
                        class="org.ametys.runtime.plugins.core.ui.item.StaticAdminUIItemFactory"
                        logger="org.ametys.runtime.plugins.core.ui.rights.profiled.profile">
                <!-- 
                    This extensions display the profile screen
                 -->
                <Static>
                    <LabelKey>PLUGINS_CORE_RIGHTS_PROFILES_LABEL</LabelKey>
                    <DescriptionKey>PLUGINS_CORE_RIGHTS_PROFILES_DESCRIPTION</DescriptionKey>
                    <Icons>
                        <Small>img/rights/profiles/icon_dock.png</Small>
                        <Medium>img/rights/profiles/icon_medium.gif</Medium>
                        <Large>img/rights/profiles/icon_large.png</Large>
                    </Icons>
                    <Action type="url">
                        <Url value="rights/profiles/view.html"/>
                    </Action>
                    <Right>Runtime_Rights_Rights_Profile_Handle</Right>
                    <Url>rights/profiles/view\.html</Url>
                </Static>
            </extension>    

            <extension  point="org.ametys.runtime.ui.item.UIItemManager" 
                        id="org.ametys.runtime.plugins.core.right.Assign"
                        class="org.ametys.runtime.plugins.core.ui.item.StaticAdminUIItemFactory"
                        logger="org.ametys.runtime.plugins.core.ui.rights.profiled.right">
                <!-- 
                    This extensions display the core affectation screen for rights
                 -->
                <Static>
                    <LabelKey>PLUGINS_CORE_RIGHTS_LABEL</LabelKey>
                    <DescriptionKey>PLUGINS_CORE_RIGHTS_DESCRIPTION</DescriptionKey>
                    <Icons>
                        <Small>img/rights/icon_dock.png</Small>
                        <Medium>img/rights/icon_medium.gif</Medium>
                        <Large>img/rights/icon_large.png</Large>
                    </Icons>
                    <Action type="url">
                        <Url value="rights/view.html"/>
                    </Action>
                    <Right>Runtime_Rights_Rights_Handle</Right>
                    <Url>rights/view\.html</Url>
                </Static>
            </extension>    
        </extensions>
    </feature>     
           
    <feature name="runtime.rights.rights">
        <!-- 
            This feature declares rights for handling rights screens
         -->
        <extensions>
            <extension point="org.ametys.runtime.plugins.core.right.RightsExtensionPoint"
                       id="runtime.use.rights.profile">
                <!-- 
                    Defines rights for handling profile and handling rights
                 -->
                <right id="Runtime_Rights_Rights_Profile_Handle">
                    <label>PLUGINS_CORE_PROFILE_RIGHTS_HANDLE_LABEL</label>
                    <description>PLUGINS_CORE_PROFILE_RIGHTS_HANDLE_DESCRIPTION</description>
                    <category>PLUGINS_CORE_USERANDRIGHTS_CATEGORY</category>
                </right>
                <right id="Runtime_Rights_Rights_Handle">
                    <label>PLUGINS_CORE_RIGHTS_HANDLE_LABEL</label>
                    <description>PLUGINS_CORE_RIGHTS_HANDLE_DESCRIPTION</description>
                    <category>PLUGINS_CORE_USERANDRIGHTS_CATEGORY</category>
                </right>
            </extension>
        </extensions>
    </feature>

                                
    <feature name="runtime.rights.impl.basic">
        <!-- 
            This feature declares the basic rights manager that always anwers OK
         -->
        <extensions>
            <extension point="org.ametys.runtime.right.RightsManager"
                       id="org.ametys.runtime.plugins.core.right.Basic"
                       class="org.ametys.runtime.plugins.core.right.BasicRightsManager"
                       logger="org.ametys.runtime.plugins.core.right.basic"/>
        </extensions>
    </feature>

    <feature name="runtime.rights.impl.profil" depends="runtime.datasource.core">
        <!-- 
            This feature declares the profile based rights manager.<br/>
            This manager use the core database pool.
            A profile is a set of atomic rights.
         -->
        <extensions>
            <extension point="org.ametys.runtime.right.RightsManager"
                       id="org.ametys.runtime.plugins.core.right.DefaultProfileBased"
                       class="org.ametys.runtime.plugins.core.right.profile.DefaultProfileBasedRightsManager"
                       logger="org.ametys.runtime.plugins.core.right.profil">
                <!--
                    See javadoc.<br/>
                    The configuration is handled in /WEB-INF/param/rights.xml.<br/>
                    The database pool is runtime.datasource.core.jdbc.pool
                 -->
                <rights config="/WEB-INF/param/rights.xml"/>
                <pool>runtime.datasource.core.jdbc.pool</pool>
            </extension>
        </extensions>
    </feature>

    <feature name="runtime.rights.impl.hierarchicalProfil" depends="runtime.datasource.core">
        <!-- 
            The same as runtime.rights.impl.profil but where rights are inherited in contexts :
            having the right on '/foo' gives the right on '/foo/subfoo'
            @see:plugin{feature/runtime.rights.impl.profil}
         -->
        <extensions>
            <extension point="org.ametys.runtime.right.RightsManager"
                       id="org.ametys.runtime.plugins.core.right.HierarchicalProfileBased"
                       class="org.ametys.runtime.plugins.core.right.profile.HierarchicalProfileBasedRightsManager"
                       logger="org.ametys.runtime.plugins.core.right.hierarchicalprofil">
                <rights config="/WEB-INF/param/rights.xml"/>
                <pool>runtime.datasource.core.jdbc.pool</pool>
            </extension>                       
        </extensions>
    </feature>
    
    <!-- +
         |  EXCEPTION
         + -->
    <feature name="runtime.exception.impl.default">
        <!-- 
            This feature has the default behavior on errors that display the embeded error pages.
         -->
        <extensions>
            <extension point="org.ametys.runtime.exception.ExceptionHandler"
                       id="org.ametys.runtime.plugins.core.exception.Default"
                       class="org.ametys.runtime.exception.DefaultExceptionHandler"
                       logger="org.ametys.runtime.exception.default"/>
        </extensions>
    </feature>
    
    <!-- +
         |  AUTHENTICATION
         + -->
    <feature name="runtime.authentication.impl.defined">
        <!-- 
            This feature defines a simple credential provider as it always answer that 'anonymous' is connected
         -->
        <extensions>
            <extension point="org.ametys.runtime.authentication.CredentialsProvider"
                       id="org.ametys.runtime.plugins.core.authentication.Defined"
                       class="org.ametys.runtime.plugins.core.authentication.DefinedCredentialsProvider"
                       logger="org.ametys.runtime.authentication.defined">
                <!-- 
                    See javadoc.<br/>
                    Configured so user is always 'anonymous'
                 -->
                <user>anonymous</user>
            </extension>
        </extensions>
    </feature>
         
    <feature name="runtime.authentication.impl.basic">
        <!-- 
            This feature defines the 'basic' credential provider (i.e. where the credential is requested to the user
            by the navigator - the incomming values are not trusted)
         -->
        <config>
            <param-ref id="runtime.authentication.basic.realm"/>
        </config>
        <extensions>
            <extension point="org.ametys.runtime.authentication.CredentialsProvider"
                       id="org.ametys.runtime.plugins.core.authentication.Basic"
                       class="org.ametys.runtime.authentication.BasicCredentialsProvider"
                       logger="org.ametys.runtime.authentication.basic"/>
        </extensions>
    </feature>

    <feature name="runtime.authentication.impl.formbased">
        <!-- 
        	This features defines the form based credential provider. Data are sent to the provider through a
        	html form. If the option is enabled, user's data can be stored with a cookie.
         -->
        <extensions>
            <extension point="org.ametys.runtime.authentication.CredentialsProvider"
                       id="org.ametys.runtime.plugins.core.authentication.FormBased"
                       class="org.ametys.runtime.plugins.core.authentication.FormBasedCredentialsProvider"
                       logger="org.ametys.runtime.authentication.formbased">
            	<username-field>Username</username-field>
            	<password-field>Password</password-field>
            	<rememberMe-field>rememberMe</rememberMe-field>
            	<cookie>
            		<cookieEnabled>true</cookieEnabled>
            		<cookieLifeTime>604800</cookieLifeTime>
            		<cookieName>AmetysAuthentication</cookieName>
            	</cookie>
            	<loginUrl internal="true">login.html</loginUrl>
            	<loginFailedUrl provideLoginParameter="true" internal="true">login_failed.html</loginFailedUrl>
            </extension>
        </extensions>
    </feature>

    <feature name="runtime.authentication.impl.remote">
        <!-- 
            This feature defines the 'remote' credential provider (i.e. where the credential is automatically setted and trusted 
            by environment in the REMOTE_USER variable)
         -->
        <config>
            <param-ref id="runtime.authentication.remote.realm"/>
        </config>
        <extensions>
            <extension point="org.ametys.runtime.authentication.CredentialsProvider"
                       id="org.ametys.runtime.plugins.core.authentication.Remote"
                       class="org.ametys.runtime.plugins.core.authentication.RemoteUserCredentialsProvider"
                       logger="org.ametys.runtime.plugins.core.authentication.remote"/>
        </extensions>
    </feature>
        
    <feature name="runtime.authentication.impl.jcifs">
        <!-- 
            This feature defines the windows NT credential provider.<br/>
            Use its extension to automatically get the login of the user connected on the NT domain : 
            user is authenticated externally and trusted by the NT environment.
         -->
        <config>
            <param-ref id="runtime.authentication.remote.realm"/>
            <param-ref id="runtime.authentication.jcifs.production"/>
            <param-ref id="runtime.authentication.jcifs.clientDomain"/>
            <param-ref id="runtime.authentication.jcifs.netBios"/>
            <param-ref id="runtime.authentication.jcifs.domainController"/>
        </config>
        <extensions>
            <extension point="org.ametys.runtime.authentication.CredentialsProvider"
                       id="org.ametys.runtime.plugins.core.authentication.Jcifs"
                       class="org.ametys.runtime.plugins.core.authentication.JcifsCredentialsProvider"
                       logger="org.ametys.runtime.plugins.core.authentication.jcifs"/>
        </extensions>
    </feature>
        
    <feature name="runtime.authentication.impl.cas">
        <!-- 
            This feature defines the 'cas' credential provider (i.e. user is authenticated externally and
            trusted by a CAS Server)
         -->
        <config>
            <param-ref id="runtime.authentication.cas.serverUrl"/>
            <param-ref id="runtime.authentication.cas.authorizedProxy"/>
        </config>
        <extensions>
            <extension point="org.ametys.runtime.authentication.CredentialsProvider"
                       id="org.ametys.runtime.plugins.core.authentication.CAS"
                       class="org.ametys.runtime.plugins.core.authentication.CASCredentialsProvider"
                       logger="org.ametys.runtime.plugins.core.authentication.cas"/>
        </extensions>
    </feature>
        
    <feature name="runtime.authentication.impl.cas.gateway">
        <!-- 
            The same as runtime.authentication.impl.cas but where CAS is configured to be used as a gateway :<br/>
            An already authenticated user is trusted but a new one can also connect !<br/>
            To give the user the oppotunity to enter its credentials you will have to manually redirect to the CAS login page.
            @see:plugin{feature/runtime.authentication.impl.cas}
            @see:plugin{config/runtime.authentication.cas.serverUrl}
         -->
        <config>
            <param-ref id="runtime.authentication.cas.serverUrl"/>
            <param-ref id="runtime.authentication.cas.authorizedProxy"/>
        </config>
        <extensions>
            <extension point="org.ametys.runtime.authentication.CredentialsProvider"
                       id="org.ametys.runtime.plugins.core.authentication.GatewayCAS"
                       class="org.ametys.runtime.plugins.core.authentication.CASCredentialsProvider"
                       logger="org.ametys.runtime.plugins.core.authentication.casgateway">
                <gateway>true</gateway>
            </extension>
        </extensions>
    </feature>
        
    <!-- +
         |  InitRequestHandler
         + -->
    <feature name="runtime.request.impl.default">
        <!-- 
            The default request handler... doing nothing
         -->
        <extensions>
            <extension point="org.ametys.runtime.request.InitRequestHandler"
                       id="org.ametys.runtime.plugins.core.request.Default"
                       class="org.ametys.runtime.request.DefaultInitRequestHandler"
                       logger="org.ametys.runtime.request.default"/>
        </extensions>
    </feature>
        
    <!-- +
         |  Monitoring
         + -->
    <feature name="runtime.monitoring">
        <!-- 
            Timer task for populating RRDs
         -->
        <components>
            <component role="org.ametys.runtime.plugins.core.monitoring.RRDsFeederTimerTask"
                       class="org.ametys.runtime.plugins.core.monitoring.RRDsFeederTimerTask"
                       logger="org.ametys.runtime.plugins.core.monitoring.RRDsFeederTimerTask"/>
        </components>
        
        <extensions>
        	<!-- Monitor the uptime of the JVM -->
            <extension point="org.ametys.runtime.plugins.core.monitoring.MonitoringExtensionPoint"
                       id="org.ametys.runtime.plugins.core.monitoring.sample.UptimeSampleManager"
                       class="org.ametys.runtime.plugins.core.monitoring.sample.UptimeSampleManager"
                       logger="org.ametys.runtime.plugins.core.monitoring.sample.UptimeSampleManager"/>
        	<!-- Monitor the throughput and the number of active HTTP requests -->
            <extension point="org.ametys.runtime.plugins.core.monitoring.MonitoringExtensionPoint"
                       id="org.ametys.runtime.plugins.core.monitoring.sample.HttpRequestSampleManager"
                       class="org.ametys.runtime.plugins.core.monitoring.sample.HttpRequestSampleManager"
                       logger="org.ametys.runtime.plugins.core.monitoring.sample.HttpRequestSampleManager"/>
        	<!-- Monitor the number of active HTTP sessions -->
            <extension point="org.ametys.runtime.plugins.core.monitoring.MonitoringExtensionPoint"
                       id="org.ametys.runtime.plugins.core.monitoring.sample.HttpSessionSampleManager"
                       class="org.ametys.runtime.plugins.core.monitoring.sample.HttpSessionSampleManager"
                       logger="org.ametys.runtime.plugins.core.monitoring.sample.HttpSessionSampleManager"/>
        	<!-- Monitor the number of live threads (total and daemon) -->
            <extension point="org.ametys.runtime.plugins.core.monitoring.MonitoringExtensionPoint"
                       id="org.ametys.runtime.plugins.core.monitoring.sample.ThreadSampleManager"
                       class="org.ametys.runtime.plugins.core.monitoring.sample.ThreadSampleManager"
                       logger="org.ametys.runtime.plugins.core.monitoring.sample.ThreadSampleManager"/>
        	<!-- Monitor the JVM heap memory status -->
            <extension point="org.ametys.runtime.plugins.core.monitoring.MonitoringExtensionPoint"
                       id="org.ametys.runtime.plugins.core.monitoring.sample.HeapMemorySampleManager"
                       class="org.ametys.runtime.plugins.core.monitoring.sample.HeapMemorySampleManager"
                       logger="org.ametys.runtime.plugins.core.monitoring.sample.HeapMemorySampleManager"/>
        	<!-- Monitor the JVM non heap memory status -->
            <extension point="org.ametys.runtime.plugins.core.monitoring.MonitoringExtensionPoint"
                       id="org.ametys.runtime.plugins.core.monitoring.sample.NonHeapMemorySampleManager"
                       class="org.ametys.runtime.plugins.core.monitoring.sample.NonHeapMemorySampleManager"
                       logger="org.ametys.runtime.plugins.core.monitoring.sample.NonHeapMemorySampleManager"/>
        </extensions>
    </feature>
        
</plugin>